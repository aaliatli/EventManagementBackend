2025-07-30 15:57:07.712 +03:00 [INF] User profile is available. Using 'C:\Users\ASUS\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-07-30 15:57:07.855 +03:00 [INF] Now listening on: http://localhost:5248
2025-07-30 15:57:07.861 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-07-30 15:57:07.862 +03:00 [INF] Hosting environment: Development
2025-07-30 15:57:07.862 +03:00 [INF] Content root path: C:\Users\ASUS\Desktop\EventManagementBackend\EventService
2025-07-30 15:57:26.796 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5248/swagger/index.html - null null
2025-07-30 15:57:26.924 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5248/swagger/index.html - 200 null text/html;charset=utf-8 130.4333ms
2025-07-30 15:57:27.177 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5248/swagger/v1/swagger.json - null null
2025-07-30 15:57:27.319 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5248/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 143.451ms
2025-07-30 15:57:29.891 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5248/swagger/index.html - null null
2025-07-30 15:57:29.895 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5248/swagger/index.html - 200 null text/html;charset=utf-8 3.7171ms
2025-07-30 15:57:30.486 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5248/swagger/v1/swagger.json - null null
2025-07-30 15:57:30.493 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5248/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 6.7773ms
2025-07-30 15:57:45.316 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5248/api/Event/export-excel - null 0
2025-07-30 15:57:45.328 +03:00 [WRN] Failed to determine the https port for redirect.
2025-07-30 15:57:45.399 +03:00 [INF] Executing endpoint 'EventController.ExportExcel (EventService)'
2025-07-30 15:57:45.430 +03:00 [INF] Route matched with {action = "ExportExcel", controller = "Event"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExportExcel() on controller EventController (EventService).
2025-07-30 15:57:45.586 +03:00 [INF] [LOG] Loglama başladı.
2025-07-30 15:57:47.726 +03:00 [INF] Executed DbCommand (64ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [e].[Id], [e].[AgeRestriction], [e].[Capacity], [e].[CreatorUserId], [e].[EndDate], [e].[IsDeleted], [e].[Location], [e].[StartDate], [e].[Title]
FROM [Events] AS [e]
2025-07-30 15:57:48.854 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [e].[Id], [e].[AgeRestriction], [e].[Capacity], [e].[CreatorUserId], [e].[EndDate], [e].[IsDeleted], [e].[Location], [e].[StartDate], [e].[Title]
FROM [Events] AS [e]
2025-07-30 15:57:49.366 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [e].[Id], [e].[AgeRestriction], [e].[Capacity], [e].[CreatorUserId], [e].[EndDate], [e].[IsDeleted], [e].[Location], [e].[StartDate], [e].[Title]
FROM [Events] AS [e]
2025-07-30 15:57:49.883 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [e].[Id], [e].[AgeRestriction], [e].[Capacity], [e].[CreatorUserId], [e].[EndDate], [e].[IsDeleted], [e].[Location], [e].[StartDate], [e].[Title]
FROM [Events] AS [e]
2025-07-30 15:57:49.905 +03:00 [INF] Executed action EventController.ExportExcel (EventService) in 4470.6417ms
2025-07-30 15:57:49.908 +03:00 [INF] Executed endpoint 'EventController.ExportExcel (EventService)'
2025-07-30 15:57:49.911 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.ArgumentException: Empty extension is not supported.
   at ClosedXML.Excel.XLWorkbook.GetSpreadsheetDocumentType(String filePath)
   at ClosedXML.Excel.XLWorkbook.SaveAs(String file, SaveOptions options)
   at ClosedXML.Excel.XLWorkbook.SaveAs(String file, Boolean validate, Boolean evaluateFormulae)
   at ClosedXML.Excel.XLWorkbook.SaveAs(String file)
   at ExportEventsToExcelCommandHandler.Handle(ExportEventsToExcelCommand request, CancellationToken cancellationToken) in C:\Users\ASUS\Desktop\EventManagementBackend\EventService\Handlers\CommandHandlers\ExportEventsToExcelCommandHandler.cs:line 42
   at Polly.Retry.AsyncRetryEngine.ImplementationAsync[TResult](Func`3 action, Context context, ExceptionPredicates shouldRetryExceptionPredicates, ResultPredicates`1 shouldRetryResultPredicates, Func`5 onRetryAsync, CancellationToken cancellationToken, Int32 permittedRetryCount, IEnumerable`1 sleepDurationsEnumerable, Func`4 sleepDurationProvider, Boolean continueOnCapturedContext)
   at Polly.AsyncPolicy.ExecuteInternalAsync[TResult](Func`3 action, Context context, Boolean continueOnCapturedContext, CancellationToken cancellationToken)
   at RetryBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in C:\Users\ASUS\Desktop\EventManagementBackend\EventService\Behaviors\RetryBehavior.cs:line 16
   at RequestValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in C:\Users\ASUS\Desktop\EventManagementBackend\EventService\Behaviors\RequestValidationBehavior.cs:line 26
   at RequestLoggingBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in C:\Users\ASUS\Desktop\EventManagementBackend\EventService\Behaviors\RequestLoggingBehavior.cs:line 11
   at MediatR.Pipeline.RequestExceptionProcessorBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken)
   at MediatR.Pipeline.RequestExceptionProcessorBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken)
   at MediatR.Pipeline.RequestExceptionActionProcessorBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken)
   at MediatR.Pipeline.RequestExceptionActionProcessorBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken)
   at MediatR.Pipeline.RequestPostProcessorBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken)
   at MediatR.Pipeline.RequestPreProcessorBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken)
   at EventController.ExportExcel() in C:\Users\ASUS\Desktop\EventManagementBackend\EventService\Controllers\EventController.cs:line 151
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-07-30 15:57:49.977 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5248/api/Event/export-excel - 500 null text/plain; charset=utf-8 4661.1513ms
2025-07-30 15:58:56.733 +03:00 [INF] Application is shutting down...
